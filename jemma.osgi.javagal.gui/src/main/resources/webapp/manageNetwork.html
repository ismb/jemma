<html>
	<head>
	</head>
	<body>
		<template id="tplManageNetwork">
			<script type="text/javascript">
				var myNMMenu = new jGGNetworkManageMenu();
					myNMMenu.newButton('btnStartGal', null, null);
					myNMMenu.newButton('btnRestartGal1', null, null);
					myNMMenu.newButton('btnRestartGal2', null, null);
					myNMMenu.newButton('btnRestartGal3', null, null);
					
				var timeout = '00002710';
				$.ajax({
					dataType:"json",
					url: DEFINEPATH.infoForRestartGal+"timeout="+timeout+"&index=00"
				}).done(function(data){
					var configData = data.detail.startupAttributeInfo;
					var mydataViewDevice = new Array();
					console.log(configData);
					
					$("#tblManageNetwork").jqGrid({ 
						     	 				  rowNum: 10000,
												  datatype: "local", 
												  colNames:[LANG.networkManage.lblChannelMask, LANG.networkManage.lblConcentratorDiscoveryTime, LANG.networkManage.lblConcentratorFlag, 
												            LANG.networkManage.lblConcentratorRadius, LANG.networkManage.lblDeviceType, LANG.networkManage.lblExtendedPANId, 
												            LANG.networkManage.lblIndirectPollRate, LANG.networkManage.lblMaxRejoinInterval, LANG.networkManage.lblNetworkKey, 
												            LANG.networkManage.lblNetworkKeySeqNum, LANG.networkManage.lblNetworkKeyType, LANG.networkManage.lblNetworkManagerAddress,
												            LANG.networkManage.lblPanId, LANG.networkManage.lblParentRetryThreshold, LANG.networkManage.lblPreconfiguredLinkKey,
												            LANG.networkManage.lblProtocolVersion, LANG.networkManage.lblRejoinInterval, LANG.networkManage.lblScanAttempts,
												            LANG.networkManage.lblShortAddress, LANG.networkManage.lblStackProfile, LANG.networkManage.lblStartupAttributeSetIndex,
												            LANG.networkManage.lblStartupControl, LANG.networkManage.lblTimeBetweenScans, LANG.networkManage.lblTrustCenterAddress,
												            LANG.networkManage.lblTrustCenterMasterKey, LANG.networkManage.lblUseInsecureJoin], 
												  colModel:[ {name:'cMask', width:165, align: "center"}, 
												             {name:'cDiscoveryT', width:180, align: "center"}, 
												             {name:'cFlag', width: 110, align: "center"}, 
												             {name:'cRadius', width:175, align: "center"}, 
												             {name:'dType', width:225, align: "center"}, 
												             {name:'ePanId', width:140, align: "center"}, 
												             {name:'iPollRate', width:150, align: "center"},
												             {name:'mRInterval', width:220, align: "center"},
												             {name:'nKey', width:180, align: "center"},
												             {name:'nKeyType', width:160, align: "center"},
												             {name:'nManAddr', width:160, align: "center"},
												             {name:'pId', width:160, align: "center"},
												             {name:'pRetryT', width:160, align: "center"},
												             {name:'pLinkK', width:160, align: "center"},
												             {name:'pVer', width:160, align: "center"},
												             {name:'rInterval', width:160, align: "center"},
												             {name:'nKeySeqNum', width:160, align: "center"},
												             {name:'sAttempts', width:160, align: "center"},
												             {name:'sAddr', width:160, align: "center"},
												             {name:'sProfile', width:160, align: "center"},
												             {name:'sAttrSetIdx', width:160, align: "center"},
												             {name:'sControl', width:160, align: "center"},
												             {name:'tBetScans', width:160, align: "center"},
												             {name:'tCenterAddr', width:160, align: "center"},
												             {name:'tCentMasterK', width:160, align: "center"},
												             {name:'uInsecurJ', width:160, align: "center"}
												           ], 		
												  sortname: 'id', 
												  viewrecords: true, 
												  caption: LANG.menu.btnManageNetwork,
										          sortorder: "desc",
										          autowidth:false,
										          subGrid:false,
										          pager:'#pager'});
					for (var iCounter = 0; iCounter < configData.length; iCounter++){
						
						mydataViewDevice.push({ cMask: configData.startupAttributeSetIndex});
					}
					//jQuery("#tblViewDevice").jqGrid('addRowData', 1, mydata);
					reloadGridFromLocalArray("tblViewDevice", mydataViewDevice);
				}); 
		        
		       	var buttonInHeaderPressed;
			    $('.tnHeaderHome2').click(function(event) {
			    	buttonInHeaderPressed = $(this).attr('id');
			    }) 
				
				$("#changeStatusGal").submit(function(event){
					
					event.preventDefault();
					var timeout, startMode;
					switch (buttonInHeaderPressed){
						case 'btnStartGal':
							timeout = '00002710';
							$.ajax({
								dataType:"json",
								url: DEFINEPATH.startGalPath+"timeout="+timeout+"&start=true"
							}).done(function(data){
								console.log('start' + data);
							}); 
							break;
						case 'btnRestartGal1':
							startMode = '00';
						case 'btnRestartGal2':
							startMode = '01';
						case 'btnRestartGal3':
							startMode = '02';
							timeout = '00002710';
							$.ajax({
								dataType:"json",
								url: DEFINEPATH.reStartGalPath+"timeout="+timeout+"&startMode="+startMode
							}).done(function(data){
								console.log('start' + data);
							}); 
							break;
					}
				});
			</script>
			<div id="container">
				<table id="tblManageNetwork"></table>
				<div id="pager"></div>
				<form id="chooseManageNetwork">
					<form id="changeStatusGal">
	            		<button id="btnStartGal" class="tnHeaderHome2" title="Avvia il GAL"></button>
						<button id="btnRestartGal1" class="tnHeaderHome2" title="Restart in ASSOCIATION Mode"></button>
						<button id="btnRestartGal2" class="tnHeaderHome2" title="Restart in NVM Mode"></button>
						<button id="btnRestartGal3" class="tnHeaderHome2" title="Restart in TC Replacement Mode"></button>
					</form>
				</form>
			</div>
		</template>
	</body>
</html>