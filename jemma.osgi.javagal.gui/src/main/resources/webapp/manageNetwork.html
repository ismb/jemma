<html>
	<head>
	</head>
	<body>
		<template id="tplManageNetwork">
			<script type="text/javascript">
				var getChannelParameters = function(){
					var rtnrString = { '11': '11', '12': '12', '13': '13', '14': '14', '15': '15', '16': '16', '17': '17', '18': '18', '19': '19', '20': '20',
							 		   '21': '21', '22': '22', '23': '23', '24': '24', '25': '25', '26': '26'};
				  	return rtnrString;
				};
				
				var getDeviceTypeParameters = function(){
					var rtnrString = { 'COORDINATOR': 'Coordinator', 'ROUTER': 'Router', 'ENDDEVICE': 'End Device'};
				  	return rtnrString;
				};
				
				var getNetworkKeyType = function(){
					var rtnrString = { 'STANDARD': 'Standard', 'HIGH_SECURITY': 'High Security'};
				  	return rtnrString;
				};
				
				var validateData = function(div, cl){
					console.log(cl);
					jQuery(div).saveRow(cl);
				}
				
				var myNMMenu = new jGGNetworkManageMenu();
					myNMMenu.newButton('btnStartGal', null, null);
					myNMMenu.newButton('btnRestartGal1', null, null);
					myNMMenu.newButton('btnRestartGal2', null, null);
					myNMMenu.newButton('btnRestartGal3', null, null);
					
				var timeout = '00002710';
				$.ajax({
					url: DEFINEPATH.infoForRestartGal+"timeout="+timeout+"&index=00"
				}).done(function(data){
					var dataBig = json_parse(data);
					var configData = dataBig.detail.startupAttributeInfo;
					
					var mydataViewDevice1 = new Array();
					var mydataViewDevice2 = new Array();
					var mydataViewDevice3 = new Array();
					var mydataViewDevice4 = new Array();
					var mydataViewDevice5 = new Array();

					mydataViewDevice1.push({ cMask: configData.channelMask, 
											 dType: configData.deviceType});
					mydataViewDevice2.push({ nKey: padVector(16, configData.networkKey)});
					mydataViewDevice3.push({ nKeyType: configData.networkKeyType, 
											 nManAddr: '0x' + padLeft(4, configData.networkManagerAddress.toString(16)).toUpperCase(), 
											 pId: '0x' + padLeft(4, configData.panId.toString(16)).toUpperCase()});
					mydataViewDevice4.push({ pLinkK: padVector(16, configData.preconfiguredLinkKey), 
											 sAddr: '0x' + padLeft(4, configData.shortAddress.toString(16)).toUpperCase()});
					mydataViewDevice5.push({ tCenterAddr: '0x' + padLeft(4, configData.trustCenterAddress.toString(16)).toUpperCase(), 
											 tCentMasterK: padVector(16, configData.trustCenterMasterKey)});
					
					$("#tblManageNetwork1").jqGrid({ 
						     	 				  rowNum: 10000,
												  datatype: "local", 
												  colNames:['Actions', LANG.networkManage.lblChannelMask, LANG.networkManage.lblDeviceType], 
												  colModel:[ {name:'act',index:'act', width:53,sortable:false}, 
												        	 {name:'cMask', index:'cMask', width: 90, align: "center",
				                                              sortable: true, editable: true, cellEdit: true, 
				                                              edittype: 'select', formatter: 'select', editrules: { required: true}, 
				                                              editoptions: {value: getChannelParameters()}},//LOAD ALL THE KPI PARAMETER KEY-VALUE PAIR
		                                                	 {name:'dType', index:'dType', width: 120, align: "center",
					                                              sortable: true, editable: true, cellEdit: true, 
					                                              edittype: 'select', formatter: 'select', editrules: { required: true}, 
					                                              editoptions: {value: getDeviceTypeParameters()}}], 		
												  sortname: 'id', 
												  viewrecords: true, 
												  caption: LANG.menu.btnManageNetwork,
										          sortorder: "desc",
										          autowidth: true,
										          subGrid: false,
										          height: "auto",
										          gridComplete: function(){
										      	  	var ids = jQuery("#tblManageNetwork1").jqGrid('getDataIDs');
										      	  	if (ids.length > 0){
											      		for(var i=0;i < ids.length;i++){
											      			var cl = ids[i];
											      			ae = "<div style='text-align: center;'>";
											      			be = "<input style='height:22px;width:70px;' type='button' value='Edit' onclick=\"jQuery('#tblManageNetwork1').editRow('"+cl+"');\"  />"; 
											    			se = "<input style='height:22px;width:70px;' type='button' value='Save' onclick=\"jQuery('#tblManageNetwork1').saveRow('"+cl+"');\"  />";  
											    			ce = "<input style='height:22px;width:70px;' type='button' value='Cancel' onclick=\"jQuery('#tblManageNetwork1').restoreRow('"+cl+"');\" />"; 
											    			de = "</div>"; 
											      			jQuery("#tblManageNetwork1").jqGrid('setRowData',ids[i],{act:ae+be+se+ce+de});
											      		}	
										      	  	}
										      	  },
										          pager:'#pager1'});
					
					$("#tblManageNetwork2").jqGrid({ 
						     	 				  rowNum: 10000,
												  datatype: "local", 
												  colNames:['Actions', LANG.networkManage.lblNetworkKey], 
												  colModel:[ {name:'act',index:'act', width:53, sortable:false}, 
												        	 {name:'nKey', width: 210, editable: true, cellEdit: true, editrules: { required: true}, align: "center"}], 		
												  sortname: 'id', 
												  viewrecords: true, 
												  caption: LANG.menu.btnManageNetwork,
										          sortorder: "desc",
										          autowidth: true,
										          subGrid: false,
										          height: "auto",
										          gridComplete: function(){
											      	  	var ids = jQuery("#tblManageNetwork2").jqGrid('getDataIDs');
											      	  	if (ids.length > 0){
												      		for(var i=0;i < ids.length;i++){ 
												      			var cl = ids[i];
												      			ae = "<div style='text-align: center;'>";
												      			be = "<input style='height:22px;width:70px;' type='button' value='Edit' onclick=\"jQuery('#tblManageNetwork2').editRow('"+cl+"');\"  />"; 
												    			se = "<input style='height:22px;width:70px;' type='button' value='Save' onclick=\"validateData('#tblManageNetwork2', '"+cl+"')\"  />";  
												    			ce = "<input style='height:22px;width:70px;' type='button' value='Cancel' onclick=\"jQuery('#tblManageNetwork2').restoreRow('"+cl+"');\" />"; 
												    			de = "</div>"; 
												      			jQuery("#tblManageNetwork2").jqGrid('setRowData',ids[i],{act:ae+be+se+ce+de});
												      		}	
											      	  	}
											      	  },
										          pager:'#pager2'});

					$("#tblManageNetwork3").jqGrid({ 
						     	 				  rowNum: 10000,
												  datatype: "local", 
												  colNames:['Actions', LANG.networkManage.lblNetworkKeyType, LANG.networkManage.lblNetworkManagerAddress, LANG.networkManage.lblPanId], 
												  colModel:[ {name:'act',index:'act', width:53, sortable:false}, 
												        	 {name:'nKeyType', width:80, align: "center",
				                                              sortable: true, editable: true, cellEdit: true, 
				                                              edittype: 'select', formatter: 'select', editrules: { required: true}, 
				                                              editoptions: {value: getNetworkKeyType()}}, 
												             {name:'nManAddr', width:80, editable: true, cellEdit: true, editrules: { required: true}, align: "center"}, 
												             {name:'pId', width:45, editable: true, cellEdit: true, editrules: { required: true}, align: "center"}], 		
												  sortname: 'id', 
												  viewrecords: true, 
												  caption: LANG.menu.btnManageNetwork,
										          sortorder: "desc",
										          autowidth: true,
										          subGrid: false,
										          height: "auto",
										          gridComplete: function(){
											      	  	var ids = jQuery("#tblManageNetwork3").jqGrid('getDataIDs');
											      	  	if (ids.length > 0){
												      		for(var i=0;i < ids.length;i++){
												      			var cl = ids[i];
												      			ae = "<div style='text-align: center;'>";
												      			be = "<input style='height:22px;width:70px;' type='button' value='Edit' onclick=\"jQuery('#tblManageNetwork3').editRow('"+cl+"');\"  />"; 
												    			se = "<input style='height:22px;width:70px;' type='button' value='Save' onclick=\"jQuery('#tblManageNetwork3').saveRow('"+cl+"');\"  />";  
												    			ce = "<input style='height:22px;width:70px;' type='button' value='Cancel' onclick=\"jQuery('#tblManageNetwork3').restoreRow('"+cl+"');\" />"; 
												    			de = "</div>"; 
												      			jQuery("#tblManageNetwork3").jqGrid('setRowData',ids[i],{act:ae+be+se+ce+de});
												      		}	
											      	  	}
											      	  },
										          pager:'#pager3'});

					$("#tblManageNetwork4").jqGrid({ 
						     	 				  rowNum: 10000,
												  datatype: "local", 
												  colNames:['Actions', LANG.networkManage.lblPreconfiguredLinkKey, LANG.networkManage.lblShortAddress], 
												  colModel:[ {name:'act',index:'act', width:54, sortable:false}, 
													         {name:'pLinkK', width:170, editable: true, cellEdit: true, editrules: { required: true}, align: "center"}, 
												             {name:'sAddr', width:40, editable: true, cellEdit: true, editrules: { required: true}, align: "center"}], 		
												  sortname: 'id', 
												  viewrecords: true, 
												  caption: LANG.menu.btnManageNetwork,
										          sortorder: "desc",
										          autowidth: true,
										          subGrid: false,
										          height: "auto",
										          gridComplete: function(){
											      	  	var ids = jQuery("#tblManageNetwork4").jqGrid('getDataIDs');
											      	  	if (ids.length > 0){
												      		for(var i=0;i < ids.length;i++){
												      			var cl = ids[i];
												      			ae = "<div style='text-align: center;'>";
												      			be = "<input style='height:22px;width:70px;' type='button' value='Edit' onclick=\"jQuery('#tblManageNetwork4').editRow('"+cl+"');\"  />"; 
												    			se = "<input style='height:22px;width:70px;' type='button' value='Save' onclick=\"jQuery('#tblManageNetwork4').saveRow('"+cl+"');\"  />";  
												    			ce = "<input style='height:22px;width:70px;' type='button' value='Cancel' onclick=\"jQuery('#tblManageNetwork4').restoreRow('"+cl+"');\" />"; 
												    			de = "</div>"; 
												      			jQuery("#tblManageNetwork4").jqGrid('setRowData',ids[i],{act:ae+be+se+ce+de});
												      		}	
											      	  	}
											      	  },
										          pager:'#pager3'});

					$("#tblManageNetwork5").jqGrid({ 
						     	 				  rowNum: 10000,
												  datatype: "local", 
												  colNames:['Actions', LANG.networkManage.lblTrustCenterAddress, LANG.networkManage.lblTrustCenterMasterKey], 
												  colModel:[ {name:'act',index:'act', width:52, sortable:false}, 
												        	 {name:'tCenterAddr', width:60, editable: true, cellEdit: true, editrules: { required: true}, align: "center"}, 
												             {name:'tCentMasterK', width:140, editable: true, cellEdit: true, editrules: { required: true}, align: "center"}], 		
												  sortname: 'id', 
												  viewrecords: true, 
												  caption: LANG.menu.btnManageNetwork,
										          sortorder: "desc",
										          autowidth: true,
										          subGrid: false,
										          height: "auto",
										          gridComplete: function(){
											      	  	var ids = jQuery("#tblManageNetwork5").jqGrid('getDataIDs');
											      	  	if (ids.length > 0){
												      		for(var i=0;i < ids.length;i++){
												      			var cl = ids[i];
												      			ae = "<div style='text-align: center;'>";
												      			be = "<input style='height:22px;width:70px;' type='button' value='Edit' onclick=\"jQuery('#tblManageNetwork5').editRow('"+cl+"');\"  />"; 
												    			se = "<input style='height:22px;width:70px;' type='button' value='Save' onclick=\"jQuery('#tblManageNetwork5').saveRow('"+cl+"');\"  />";  
												    			ce = "<input style='height:22px;width:70px;' type='button' value='Cancel' onclick=\"jQuery('#tblManageNetwork5').restoreRow('"+cl+"');\" />";
												      			de = "</div>"; 
												      			jQuery("#tblManageNetwork5").jqGrid('setRowData',ids[i],{act:ae+be+se+ce+de});
												      		}	
											      	  	}
											      	  },
										          pager:'#pager5'});

					reloadGridFromLocalArray("tblManageNetwork1", mydataViewDevice1);
					reloadGridFromLocalArray("tblManageNetwork2", mydataViewDevice2);
					reloadGridFromLocalArray("tblManageNetwork3", mydataViewDevice3);
					reloadGridFromLocalArray("tblManageNetwork4", mydataViewDevice4);
					reloadGridFromLocalArray("tblManageNetwork5", mydataViewDevice5);
				});
		        
		       	var buttonInHeaderPressed;
			    $('.tnHeaderHome2').click(function(event) {
			    	buttonInHeaderPressed = $(this).attr('id');
			    });
				
				$("#changeStatusGal").submit(function(event){
					
					event.preventDefault();
					var timeout, startMode;
					switch (buttonInHeaderPressed){
						case 'btnStartGal':
							timeout = '00002710';
							$.ajax({
								type: "POST",
								dataType:"json",
								data: { name: "John", location: "Boston" },
								url: DEFINEPATH.startGalPath+"timeout="+timeout+"&start=true"
							}).done(function(data){
								console.log('start' + data);
							}); 
							break;
						case 'btnRestartGal1':
							startMode = '00';
						case 'btnRestartGal2':
							startMode = '01';
						case 'btnRestartGal3':
							startMode = '02';
							timeout = '00002710';
							$.ajax({
								dataType:"json",
								url: DEFINEPATH.reStartGalPath+"timeout="+timeout+"&startMode="+startMode
							}).done(function(data){
								console.log('start' + data);
							}); 
							break;
					}
				});
			</script>
					
			<div id="container">
				<table id="tblManageNetwork1"></table>
				<div id="pager1"></div>
				<table id="tblManageNetwork2"></table>
				<div id="pager2"></div>
				<table id="tblManageNetwork3"></table>
				<div id="pager3"></div>
				<table id="tblManageNetwork4"></table>
				<div id="pager4"></div>
				<table id="tblManageNetwork5"></table>
				<div id="pager5"></div>
				<form id="changeStatusGal" style='text-align: center;'>
            		<button id="btnStartGal" class="tnHeaderHome2" title="Avvia il GAL"></button>
					<button id="btnRestartGal1" class="tnHeaderHome2" title="Restart in ASSOCIATION Mode"></button>
					<button id="btnRestartGal2" class="tnHeaderHome2" title="Restart in NVM Mode"></button>
					<button id="btnRestartGal3" class="tnHeaderHome2" title="Restart in TC Replacement Mode"></button>
				</form>
			</div>
		</template>
	</body>
</html>